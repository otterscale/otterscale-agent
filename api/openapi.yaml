openapi: 3.1.0
info:
  title: OtterScale API
  description: 'OtterScale: A unified platform for simplified compute, storage, and networking.'
  contact:
    name: Chung-Hsuan Tsai
    url: https://iasthc.github.io
    email: paul_tsai@phison.com
  license:
    name: Apache 2.0
    url: https://opensource.org/license/apache-2-0
  version: v1
paths:
  /otterscale.resource.v1.ResourceService/Apply:
    post:
      tags:
        - ResourceService
      summary: Apply
      description: |-
        Apply performs a Server-Side Apply (SSA) to update or create a resource.
         This is the recommended way to perform partial updates.
      operationId: ResourceService_Apply
      parameters:
        - name: Connect-Protocol-Version
          in: header
          required: true
          schema:
            $ref: '#/components/schemas/connect-protocol-version'
        - name: Connect-Timeout-Ms
          in: header
          schema:
            $ref: '#/components/schemas/connect-timeout-header'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/otterscale.resource.v1.ApplyRequest'
        required: true
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/connect.error'
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/otterscale.resource.v1.Resource'
  /otterscale.resource.v1.ResourceService/Create:
    post:
      tags:
        - ResourceService
      summary: Create
      description: Create creates a new resource in the cluster using the provided manifest.
      operationId: ResourceService_Create
      parameters:
        - name: Connect-Protocol-Version
          in: header
          required: true
          schema:
            $ref: '#/components/schemas/connect-protocol-version'
        - name: Connect-Timeout-Ms
          in: header
          schema:
            $ref: '#/components/schemas/connect-timeout-header'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/otterscale.resource.v1.CreateRequest'
        required: true
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/connect.error'
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/otterscale.resource.v1.Resource'
  /otterscale.resource.v1.ResourceService/Delete:
    post:
      tags:
        - ResourceService
      summary: Delete
      description: Delete removes a resource from the cluster by its name.
      operationId: ResourceService_Delete
      parameters:
        - name: Connect-Protocol-Version
          in: header
          required: true
          schema:
            $ref: '#/components/schemas/connect-protocol-version'
        - name: Connect-Timeout-Ms
          in: header
          schema:
            $ref: '#/components/schemas/connect-timeout-header'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/otterscale.resource.v1.DeleteRequest'
        required: true
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/connect.error'
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/google.protobuf.Empty'
  /otterscale.resource.v1.ResourceService/Discovery:
    post:
      tags:
        - ResourceService
      summary: Discovery
      description: Discovery retrieves the available API resources in the specified cluster.
      operationId: ResourceService_Discovery
      parameters:
        - name: Connect-Protocol-Version
          in: header
          required: true
          schema:
            $ref: '#/components/schemas/connect-protocol-version'
        - name: Connect-Timeout-Ms
          in: header
          schema:
            $ref: '#/components/schemas/connect-timeout-header'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/otterscale.resource.v1.DiscoveryRequest'
        required: true
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/connect.error'
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/otterscale.resource.v1.DiscoveryResponse'
  /otterscale.resource.v1.ResourceService/Get:
    post:
      tags:
        - ResourceService
      summary: Get
      description: Get retrieves a single resource by its name within a namespace.
      operationId: ResourceService_Get
      parameters:
        - name: Connect-Protocol-Version
          in: header
          required: true
          schema:
            $ref: '#/components/schemas/connect-protocol-version'
        - name: Connect-Timeout-Ms
          in: header
          schema:
            $ref: '#/components/schemas/connect-timeout-header'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/otterscale.resource.v1.GetRequest'
        required: true
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/connect.error'
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/otterscale.resource.v1.Resource'
  /otterscale.resource.v1.ResourceService/List:
    post:
      tags:
        - ResourceService
      summary: List
      description: List retrieves a collection of resources based on the provided GVR and filters.
      operationId: ResourceService_List
      parameters:
        - name: Connect-Protocol-Version
          in: header
          required: true
          schema:
            $ref: '#/components/schemas/connect-protocol-version'
        - name: Connect-Timeout-Ms
          in: header
          schema:
            $ref: '#/components/schemas/connect-timeout-header'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/otterscale.resource.v1.ListRequest'
        required: true
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/connect.error'
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/otterscale.resource.v1.ListResponse'
  /otterscale.resource.v1.ResourceService/Schema:
    post:
      tags:
        - ResourceService
      summary: Schema
      description: |-
        Schema retrieves the structural definition (JSON Schema) for a specific resource type.
         It supports both native Kubernetes resources and installed CRDs.
         The raw JSON Schema (Draft 4/7 or 2020-12) describing the resource structure.
         This is typically derived from Kubernetes OpenAPIV3Schema.
      operationId: ResourceService_Schema
      parameters:
        - name: Connect-Protocol-Version
          in: header
          required: true
          schema:
            $ref: '#/components/schemas/connect-protocol-version'
        - name: Connect-Timeout-Ms
          in: header
          schema:
            $ref: '#/components/schemas/connect-timeout-header'
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/otterscale.resource.v1.SchemaRequest'
        required: true
      responses:
        default:
          description: Error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/connect.error'
        "200":
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/google.protobuf.Struct'
  /otterscale.resource.v1.ResourceService/Watch: {}
components:
  schemas:
    connect-protocol-version:
      type: number
      title: Connect-Protocol-Version
      enum:
        - 1
      description: Define the version of the Connect protocol
      const: 1
    connect-timeout-header:
      type: number
      title: Connect-Timeout-Ms
      description: Define the timeout, in ms
    connect.error:
      type: object
      properties:
        code:
          type: string
          examples:
            - not_found
          enum:
            - canceled
            - unknown
            - invalid_argument
            - deadline_exceeded
            - not_found
            - already_exists
            - permission_denied
            - resource_exhausted
            - failed_precondition
            - aborted
            - out_of_range
            - unimplemented
            - internal
            - unavailable
            - data_loss
            - unauthenticated
          description: The status code, which should be an enum value of [google.rpc.Code][google.rpc.Code].
        message:
          type: string
          description: A developer-facing error message, which should be in English. Any user-facing error message should be localized and sent in the [google.rpc.Status.details][google.rpc.Status.details] field, or localized by the client.
        details:
          type: array
          items:
            $ref: '#/components/schemas/connect.error_details.Any'
          description: A list of messages that carry the error details. There is no limit on the number of messages.
      title: Connect Error
      additionalProperties: true
      description: 'Error type returned by Connect: https://connectrpc.com/docs/go/errors/#http-representation'
    connect.error_details.Any:
      type: object
      properties:
        type:
          type: string
          description: 'A URL that acts as a globally unique identifier for the type of the serialized message. For example: `type.googleapis.com/google.rpc.ErrorInfo`. This is used to determine the schema of the data in the `value` field and is the discriminator for the `debug` field.'
        value:
          type: string
          format: binary
          description: The Protobuf message, serialized as bytes and base64-encoded. The specific message type is identified by the `type` field.
        debug:
          oneOf:
            - type: object
              title: Any
              additionalProperties: true
              description: Detailed error information.
          discriminator:
            propertyName: type
          title: Debug
          description: Deserialized error detail payload. The 'type' field indicates the schema. This field is for easier debugging and should not be relied upon for application logic.
      additionalProperties: true
      description: Contains an arbitrary serialized message along with a @type that describes the type of the serialized message, with an additional debug field for ConnectRPC error details.
    google.protobuf.Empty:
      type: object
      description: |-
        A generic empty message that you can re-use to avoid defining duplicated
         empty messages in your APIs. A typical example is to use it as the request
         or the response type of an API method. For instance:

             service Foo {
               rpc Bar(google.protobuf.Empty) returns (google.protobuf.Empty);
             }
    google.protobuf.ListValue:
      type: object
      properties:
        values:
          type: array
          items:
            $ref: '#/components/schemas/google.protobuf.Value'
          title: values
          description: Repeated field of dynamically typed values.
      title: ListValue
      additionalProperties: false
      description: |-
        `ListValue` is a wrapper around a repeated field of values.

         The JSON representation for `ListValue` is JSON array.
    google.protobuf.NullValue:
      type: string
      title: NullValue
      enum:
        - NULL_VALUE
      description: |-
        `NullValue` is a singleton enumeration to represent the null value for the
         `Value` type union.

         The JSON representation for `NullValue` is JSON `null`.
    google.protobuf.Struct:
      type: object
      additionalProperties:
        $ref: '#/components/schemas/google.protobuf.Value'
      description: |-
        `Struct` represents a structured data value, consisting of fields
         which map to dynamically typed values. In some languages, `Struct`
         might be supported by a native representation. For example, in
         scripting languages like JS a struct is represented as an
         object. The details of that representation are described together
         with the proto support for the language.

         The JSON representation for `Struct` is JSON object.
    google.protobuf.Struct.FieldsEntry:
      type: object
      properties:
        key:
          type: string
          title: key
        value:
          title: value
          $ref: '#/components/schemas/google.protobuf.Value'
      title: FieldsEntry
      additionalProperties: false
    google.protobuf.Value:
      oneOf:
        - type: "null"
        - type: number
        - type: string
        - type: boolean
        - type: array
        - type: object
          additionalProperties: true
      description: |-
        `Value` represents a dynamically typed value which can be either
         null, a number, a string, a boolean, a recursive struct value, or a
         list of values. A producer of value is expected to set one of these
         variants. Absence of any variant indicates an error.

         The JSON representation for `Value` is JSON value.
    otterscale.api.Feature:
      type: object
      properties:
        name:
          type: string
          title: name
      title: Feature
      additionalProperties: false
    otterscale.resource.v1.APIResource:
      type: object
      properties:
        group:
          type: string
          title: group
        version:
          type: string
          title: version
        resource:
          type: string
          title: resource
        kind:
          type: string
          title: kind
        namespaced:
          type: boolean
          title: namespaced
        verbs:
          type: array
          items:
            type: string
          title: verbs
        shortNames:
          type: array
          items:
            type: string
          title: short_names
      title: APIResource
      additionalProperties: false
      description: APIResource represents a Kubernetes API resource with its metadata.
    otterscale.resource.v1.ApplyRequest:
      type: object
      properties:
        cluster:
          type: string
          title: cluster
        group:
          type: string
          title: group
        version:
          type: string
          title: version
        resource:
          type: string
          title: resource
        namespace:
          type: string
          title: namespace
        name:
          type: string
          title: name
        manifest:
          type: string
          title: manifest
          format: byte
          description: A partial or YAML manifest in JSON format to be merged by the API server.
        force:
          type: boolean
          title: force
        fieldManager:
          type: string
          title: field_manager
          description: Identifies the entity managing the fields (e.g., "otterscale-web-ui"). Required for SSA.
      title: ApplyRequest
      additionalProperties: false
      description: ApplyRequest defines the parameters for Server-Side Apply (SSA).
    otterscale.resource.v1.CreateRequest:
      type: object
      properties:
        cluster:
          type: string
          title: cluster
        group:
          type: string
          title: group
        version:
          type: string
          title: version
        resource:
          type: string
          title: resource
        namespace:
          type: string
          title: namespace
        manifest:
          type: string
          title: manifest
          format: byte
          description: The full manifest of the object to be created in YAML format.
      title: CreateRequest
      additionalProperties: false
      description: CreateRequest defines the parameters for creating a new object.
    otterscale.resource.v1.DeleteRequest:
      type: object
      properties:
        cluster:
          type: string
          title: cluster
        group:
          type: string
          title: group
        version:
          type: string
          title: version
        resource:
          type: string
          title: resource
        namespace:
          type: string
          title: namespace
        name:
          type: string
          title: name
        gracePeriodSeconds:
          type:
            - integer
            - string
          title: grace_period_seconds
          format: int64
      title: DeleteRequest
      additionalProperties: false
      description: DeleteRequest defines the parameters to remove an object.
    otterscale.resource.v1.DiscoveryRequest:
      type: object
      properties:
        cluster:
          type: string
          title: cluster
          description: The target Kubernetes cluster identifier.
      title: DiscoveryRequest
      additionalProperties: false
      description: DiscoveryRequest defines the parameters for discovering API resources.
    otterscale.resource.v1.DiscoveryResponse:
      type: object
      properties:
        apiResources:
          type: array
          items:
            $ref: '#/components/schemas/otterscale.resource.v1.APIResource'
          title: api_resources
          description: The list of available API resources in the cluster.
      title: DiscoveryResponse
      additionalProperties: false
      description: DiscoveryResponse contains the list of available API resources in the cluster.
    otterscale.resource.v1.GetRequest:
      type: object
      properties:
        cluster:
          type: string
          title: cluster
        group:
          type: string
          title: group
        version:
          type: string
          title: version
        resource:
          type: string
          title: resource
        namespace:
          type: string
          title: namespace
        name:
          type: string
          title: name
      title: GetRequest
      additionalProperties: false
      description: GetRequest defines the parameters to fetch a single object.
    otterscale.resource.v1.ListRequest:
      type: object
      properties:
        cluster:
          type: string
          title: cluster
          description: The target Kubernetes cluster identifier.
        group:
          type: string
          title: group
          description: Kubernetes API Group (e.g., "apps" for Deployments, "" for core resources like Pods).
        version:
          type: string
          title: version
          description: Kubernetes API Version (e.g., "v1").
        resource:
          type: string
          title: resource
          description: Kubernetes API Resource name in plural (e.g., "pods", "deployments").
        namespace:
          type: string
          title: namespace
          description: The namespace to query. If empty, the request may target all namespaces depending on cluster permissions.
        labelSelector:
          type: string
          title: label_selector
          description: A selector to restrict the list of returned objects by their labels.
        fieldSelector:
          type: string
          title: field_selector
          description: A selector to restrict the list of returned objects by their fields (e.g., "status.phase=Running").
        limit:
          type:
            - integer
            - string
          title: limit
          format: int64
          description: The maximum number of items to return in a single page.
        continue:
          type: string
          title: continue
          description: The continue token for pagination, retrieved from a previous ListResponse.
      title: ListRequest
      additionalProperties: false
      description: ListRequest defines the parameters for querying multiple resources.
    otterscale.resource.v1.ListResponse:
      type: object
      properties:
        resourceVersion:
          type: string
          title: resource_version
          description: The resourceVersion of the list, used to initiate a Watch from a specific point in time.
        continue:
          type: string
          title: continue
          description: A token used to retrieve the next page of results. Empty if no more pages exist.
        remainingItemCount:
          type:
            - integer
            - string
          title: remaining_item_count
          format: int64
          description: The estimated number of items remaining if pagination is used.
        items:
          type: array
          items:
            $ref: '#/components/schemas/otterscale.resource.v1.Resource'
          title: items
          description: The list of resources found.
      title: ListResponse
      additionalProperties: false
      description: ListResponse contains the requested list of resources and pagination metadata.
    otterscale.resource.v1.Resource:
      type: object
      properties:
        object:
          title: object
          description: |-
            The full JSON representation of the Kubernetes object.
             Note: Backend may strip managedFields to reduce payload size.
          $ref: '#/components/schemas/google.protobuf.Struct'
      title: Resource
      additionalProperties: false
      description: Resource represents a single Kubernetes object serialized as a JSON string.
    otterscale.resource.v1.SchemaRequest:
      type: object
      properties:
        cluster:
          type: string
          title: cluster
          description: The target Kubernetes cluster identifier.
        group:
          type: string
          title: group
          description: Kubernetes API Group (e.g., "apps" for Deployments, "" for core resources like Pods).
        version:
          type: string
          title: version
          description: Kubernetes API Version (e.g., "v1").
        kind:
          type: string
          title: kind
          description: Kubernetes API Kind (e,g, "Pod").
      title: SchemaRequest
      additionalProperties: false
      description: SchemaRequest defines the parameters to retrieve the schema of a specific GVR.
    otterscale.resource.v1.WatchEvent:
      type: object
      properties:
        type:
          title: type
          description: The type of the watch event.
          $ref: '#/components/schemas/otterscale.resource.v1.WatchEvent.Type'
        resource:
          title: resource
          description: The state of the resource associated with the event.
          $ref: '#/components/schemas/otterscale.resource.v1.Resource'
        resourceVersion:
          type: string
          title: resource_version
          description: The resourceVersion of the watch event, used to initiate a Watch from a specific point in time.
      title: WatchEvent
      additionalProperties: false
      description: WatchEvent represents a single change notification from the Kubernetes API.
    otterscale.resource.v1.WatchEvent.Type:
      type: string
      title: Type
      enum:
        - TYPE_UNSPECIFIED
        - TYPE_ADDED
        - TYPE_MODIFIED
        - TYPE_DELETED
        - TYPE_BOOKMARK
        - TYPE_ERROR
      description: Type defines the possible types of events from Kubernetes watch.
    otterscale.resource.v1.WatchRequest:
      type: object
      properties:
        cluster:
          type: string
          title: cluster
        group:
          type: string
          title: group
        version:
          type: string
          title: version
        resource:
          type: string
          title: resource
        namespace:
          type: string
          title: namespace
        labelSelector:
          type: string
          title: label_selector
        fieldSelector:
          type: string
          title: field_selector
        resourceVersion:
          type: string
          title: resource_version
          description: Start the watch from this specific resource version.
      title: WatchRequest
      additionalProperties: false
      description: WatchRequest defines the parameters to start a streaming watch.
  securitySchemes:
    BasicAuth:
      type: http
      scheme: basic
security: []
tags:
  - name: ResourceService
    description: |-
      ResourceService provides a generic interface to manage any Kubernetes resources,
       including native objects (Pods, Deployments) and Custom Resource Definitions (CRDs).
externalDocs:
  description: Website
  url: https://otterscale.github.io
